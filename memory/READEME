Some code was from http://os.phil-opp.com/allocating-frames.html licensed under the MIT License.
